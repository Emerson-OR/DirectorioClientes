{% extends "base.html" %}
{% block content %}
<h1>Directorio de Clientes</h1>

<!-- Mostrar "Agregar Cliente" solo si es admin o superadmin -->
{% if user.is_superuser or user.rol == 'admin' or user.rol == 'superadmin' %}
  <div class="flex gap-2 mb-3">
    <a class="btn btn-primary" href="{% url 'agregar_cliente' %}">Agregar Cliente</a>
    <a class="btn btn-warning" href="{% url 'clientes_eliminados' %}">🗑️ Ver clientes eliminados</a>
  </div>
{% endif %}


<div class="row">
  {% for cliente in clientes %}
    <div class="col-md-4 mb-3">
      <div class="card p-2 shadow-sm">
        {% if cliente.logo %}
          <img src="{{ cliente.logo.url }}" class="card-img-top" style="max-height:140px;object-fit:contain;">
        {% else %}
          <div class="bg-light text-center py-5 text-muted">
            <small>Sin logo</small>
          </div>
        {% endif %}

        <div class="card-body">
          <h5 class="card-title">{{ cliente.nombre }}</h5>
          <p class="card-text">
            <strong>Compañía:</strong> {{ cliente.compania }}<br>
            <strong>ID:</strong> {{ cliente.identificacion }}
          </p>

          <div class="d-flex justify-content-between">
            <!-- Todos los usuarios pueden ver -->
            <a href="{% url 'detalle_cliente' cliente.pk %}" class="btn btn-info btn-sm">
              Ver detalles
            </a>

            <!-- Solo admin/superadmin puede eliminar -->
            {% if user.is_superuser or user.rol == 'admin' or user.rol == 'superadmin' %}
              <a href="{% url 'eliminar_cliente' cliente.pk %}" class="btn btn-danger btn-sm">
                Eliminar
              </a>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  {% empty %}
    <p>No hay clientes registrados.</p>
  {% endfor %}
</div>
{% endblock %}
